{
  "cells": [
    {
      "cell_type": "code",
      "execution_count": 1,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "3x1kJKeeu8Kp",
        "outputId": "c9329893-0b76-4c21-8acd-e9e637d1e686"
      },
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "Collecting fastapi\n",
            "  Downloading fastapi-0.115.12-py3-none-any.whl.metadata (27 kB)\n",
            "Collecting uvicorn\n",
            "  Downloading uvicorn-0.34.2-py3-none-any.whl.metadata (6.5 kB)\n",
            "Collecting pyngrok\n",
            "  Downloading pyngrok-7.2.8-py3-none-any.whl.metadata (10 kB)\n",
            "Requirement already satisfied: nest-asyncio in /usr/local/lib/python3.11/dist-packages (1.6.0)\n",
            "Requirement already satisfied: torch in /usr/local/lib/python3.11/dist-packages (2.6.0+cu124)\n",
            "Requirement already satisfied: torchvision in /usr/local/lib/python3.11/dist-packages (0.21.0+cu124)\n",
            "Requirement already satisfied: pillow in /usr/local/lib/python3.11/dist-packages (11.2.1)\n",
            "Requirement already satisfied: numpy in /usr/local/lib/python3.11/dist-packages (2.0.2)\n",
            "Requirement already satisfied: requests in /usr/local/lib/python3.11/dist-packages (2.32.3)\n",
            "Collecting bs4\n",
            "  Downloading bs4-0.0.2-py2.py3-none-any.whl.metadata (411 bytes)\n",
            "Collecting python-multipart\n",
            "  Downloading python_multipart-0.0.20-py3-none-any.whl.metadata (1.8 kB)\n",
            "Collecting starlette<0.47.0,>=0.40.0 (from fastapi)\n",
            "  Downloading starlette-0.46.2-py3-none-any.whl.metadata (6.2 kB)\n",
            "Requirement already satisfied: pydantic!=1.8,!=1.8.1,!=2.0.0,!=2.0.1,!=2.1.0,<3.0.0,>=1.7.4 in /usr/local/lib/python3.11/dist-packages (from fastapi) (2.11.4)\n",
            "Requirement already satisfied: typing-extensions>=4.8.0 in /usr/local/lib/python3.11/dist-packages (from fastapi) (4.13.2)\n",
            "Requirement already satisfied: click>=7.0 in /usr/local/lib/python3.11/dist-packages (from uvicorn) (8.2.0)\n",
            "Requirement already satisfied: h11>=0.8 in /usr/local/lib/python3.11/dist-packages (from uvicorn) (0.16.0)\n",
            "Requirement already satisfied: PyYAML>=5.1 in /usr/local/lib/python3.11/dist-packages (from pyngrok) (6.0.2)\n",
            "Requirement already satisfied: filelock in /usr/local/lib/python3.11/dist-packages (from torch) (3.18.0)\n",
            "Requirement already satisfied: networkx in /usr/local/lib/python3.11/dist-packages (from torch) (3.4.2)\n",
            "Requirement already satisfied: jinja2 in /usr/local/lib/python3.11/dist-packages (from torch) (3.1.6)\n",
            "Requirement already satisfied: fsspec in /usr/local/lib/python3.11/dist-packages (from torch) (2025.3.2)\n",
            "Collecting nvidia-cuda-nvrtc-cu12==12.4.127 (from torch)\n",
            "  Downloading nvidia_cuda_nvrtc_cu12-12.4.127-py3-none-manylinux2014_x86_64.whl.metadata (1.5 kB)\n",
            "Collecting nvidia-cuda-runtime-cu12==12.4.127 (from torch)\n",
            "  Downloading nvidia_cuda_runtime_cu12-12.4.127-py3-none-manylinux2014_x86_64.whl.metadata (1.5 kB)\n",
            "Collecting nvidia-cuda-cupti-cu12==12.4.127 (from torch)\n",
            "  Downloading nvidia_cuda_cupti_cu12-12.4.127-py3-none-manylinux2014_x86_64.whl.metadata (1.6 kB)\n",
            "Collecting nvidia-cudnn-cu12==9.1.0.70 (from torch)\n",
            "  Downloading nvidia_cudnn_cu12-9.1.0.70-py3-none-manylinux2014_x86_64.whl.metadata (1.6 kB)\n",
            "Collecting nvidia-cublas-cu12==12.4.5.8 (from torch)\n",
            "  Downloading nvidia_cublas_cu12-12.4.5.8-py3-none-manylinux2014_x86_64.whl.metadata (1.5 kB)\n",
            "Collecting nvidia-cufft-cu12==11.2.1.3 (from torch)\n",
            "  Downloading nvidia_cufft_cu12-11.2.1.3-py3-none-manylinux2014_x86_64.whl.metadata (1.5 kB)\n",
            "Collecting nvidia-curand-cu12==10.3.5.147 (from torch)\n",
            "  Downloading nvidia_curand_cu12-10.3.5.147-py3-none-manylinux2014_x86_64.whl.metadata (1.5 kB)\n",
            "Collecting nvidia-cusolver-cu12==11.6.1.9 (from torch)\n",
            "  Downloading nvidia_cusolver_cu12-11.6.1.9-py3-none-manylinux2014_x86_64.whl.metadata (1.6 kB)\n",
            "Collecting nvidia-cusparse-cu12==12.3.1.170 (from torch)\n",
            "  Downloading nvidia_cusparse_cu12-12.3.1.170-py3-none-manylinux2014_x86_64.whl.metadata (1.6 kB)\n",
            "Requirement already satisfied: nvidia-cusparselt-cu12==0.6.2 in /usr/local/lib/python3.11/dist-packages (from torch) (0.6.2)\n",
            "Requirement already satisfied: nvidia-nccl-cu12==2.21.5 in /usr/local/lib/python3.11/dist-packages (from torch) (2.21.5)\n",
            "Requirement already satisfied: nvidia-nvtx-cu12==12.4.127 in /usr/local/lib/python3.11/dist-packages (from torch) (12.4.127)\n",
            "Collecting nvidia-nvjitlink-cu12==12.4.127 (from torch)\n",
            "  Downloading nvidia_nvjitlink_cu12-12.4.127-py3-none-manylinux2014_x86_64.whl.metadata (1.5 kB)\n",
            "Requirement already satisfied: triton==3.2.0 in /usr/local/lib/python3.11/dist-packages (from torch) (3.2.0)\n",
            "Requirement already satisfied: sympy==1.13.1 in /usr/local/lib/python3.11/dist-packages (from torch) (1.13.1)\n",
            "Requirement already satisfied: mpmath<1.4,>=1.1.0 in /usr/local/lib/python3.11/dist-packages (from sympy==1.13.1->torch) (1.3.0)\n",
            "Requirement already satisfied: charset-normalizer<4,>=2 in /usr/local/lib/python3.11/dist-packages (from requests) (3.4.2)\n",
            "Requirement already satisfied: idna<4,>=2.5 in /usr/local/lib/python3.11/dist-packages (from requests) (3.10)\n",
            "Requirement already satisfied: urllib3<3,>=1.21.1 in /usr/local/lib/python3.11/dist-packages (from requests) (2.4.0)\n",
            "Requirement already satisfied: certifi>=2017.4.17 in /usr/local/lib/python3.11/dist-packages (from requests) (2025.4.26)\n",
            "Requirement already satisfied: beautifulsoup4 in /usr/local/lib/python3.11/dist-packages (from bs4) (4.13.4)\n",
            "Requirement already satisfied: annotated-types>=0.6.0 in /usr/local/lib/python3.11/dist-packages (from pydantic!=1.8,!=1.8.1,!=2.0.0,!=2.0.1,!=2.1.0,<3.0.0,>=1.7.4->fastapi) (0.7.0)\n",
            "Requirement already satisfied: pydantic-core==2.33.2 in /usr/local/lib/python3.11/dist-packages (from pydantic!=1.8,!=1.8.1,!=2.0.0,!=2.0.1,!=2.1.0,<3.0.0,>=1.7.4->fastapi) (2.33.2)\n",
            "Requirement already satisfied: typing-inspection>=0.4.0 in /usr/local/lib/python3.11/dist-packages (from pydantic!=1.8,!=1.8.1,!=2.0.0,!=2.0.1,!=2.1.0,<3.0.0,>=1.7.4->fastapi) (0.4.0)\n",
            "Requirement already satisfied: anyio<5,>=3.6.2 in /usr/local/lib/python3.11/dist-packages (from starlette<0.47.0,>=0.40.0->fastapi) (4.9.0)\n",
            "Requirement already satisfied: soupsieve>1.2 in /usr/local/lib/python3.11/dist-packages (from beautifulsoup4->bs4) (2.7)\n",
            "Requirement already satisfied: MarkupSafe>=2.0 in /usr/local/lib/python3.11/dist-packages (from jinja2->torch) (3.0.2)\n",
            "Requirement already satisfied: sniffio>=1.1 in /usr/local/lib/python3.11/dist-packages (from anyio<5,>=3.6.2->starlette<0.47.0,>=0.40.0->fastapi) (1.3.1)\n",
            "Downloading fastapi-0.115.12-py3-none-any.whl (95 kB)\n",
            "\u001b[2K   \u001b[90m‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\u001b[0m \u001b[32m95.2/95.2 kB\u001b[0m \u001b[31m3.8 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n",
            "\u001b[?25hDownloading uvicorn-0.34.2-py3-none-any.whl (62 kB)\n",
            "\u001b[2K   \u001b[90m‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\u001b[0m \u001b[32m62.5/62.5 kB\u001b[0m \u001b[31m3.3 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n",
            "\u001b[?25hDownloading pyngrok-7.2.8-py3-none-any.whl (25 kB)\n",
            "Downloading nvidia_cublas_cu12-12.4.5.8-py3-none-manylinux2014_x86_64.whl (363.4 MB)\n",
            "\u001b[2K   \u001b[90m‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\u001b[0m \u001b[32m363.4/363.4 MB\u001b[0m \u001b[31m3.9 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n",
            "\u001b[?25hDownloading nvidia_cuda_cupti_cu12-12.4.127-py3-none-manylinux2014_x86_64.whl (13.8 MB)\n",
            "\u001b[2K   \u001b[90m‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\u001b[0m \u001b[32m13.8/13.8 MB\u001b[0m \u001b[31m96.7 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n",
            "\u001b[?25hDownloading nvidia_cuda_nvrtc_cu12-12.4.127-py3-none-manylinux2014_x86_64.whl (24.6 MB)\n",
            "\u001b[2K   \u001b[90m‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\u001b[0m \u001b[32m24.6/24.6 MB\u001b[0m \u001b[31m20.1 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n",
            "\u001b[?25hDownloading nvidia_cuda_runtime_cu12-12.4.127-py3-none-manylinux2014_x86_64.whl (883 kB)\n",
            "\u001b[2K   \u001b[90m‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\u001b[0m \u001b[32m883.7/883.7 kB\u001b[0m \u001b[31m42.8 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n",
            "\u001b[?25hDownloading nvidia_cudnn_cu12-9.1.0.70-py3-none-manylinux2014_x86_64.whl (664.8 MB)\n",
            "\u001b[2K   \u001b[90m‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\u001b[0m \u001b[32m664.8/664.8 MB\u001b[0m \u001b[31m2.8 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n",
            "\u001b[?25hDownloading nvidia_cufft_cu12-11.2.1.3-py3-none-manylinux2014_x86_64.whl (211.5 MB)\n",
            "\u001b[2K   \u001b[90m‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\u001b[0m \u001b[32m211.5/211.5 MB\u001b[0m \u001b[31m5.9 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n",
            "\u001b[?25hDownloading nvidia_curand_cu12-10.3.5.147-py3-none-manylinux2014_x86_64.whl (56.3 MB)\n",
            "\u001b[2K   \u001b[90m‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\u001b[0m \u001b[32m56.3/56.3 MB\u001b[0m \u001b[31m15.8 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n",
            "\u001b[?25hDownloading nvidia_cusolver_cu12-11.6.1.9-py3-none-manylinux2014_x86_64.whl (127.9 MB)\n",
            "\u001b[2K   \u001b[90m‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\u001b[0m \u001b[32m127.9/127.9 MB\u001b[0m \u001b[31m7.2 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n",
            "\u001b[?25hDownloading nvidia_cusparse_cu12-12.3.1.170-py3-none-manylinux2014_x86_64.whl (207.5 MB)\n",
            "\u001b[2K   \u001b[90m‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\u001b[0m \u001b[32m207.5/207.5 MB\u001b[0m \u001b[31m6.0 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n",
            "\u001b[?25hDownloading nvidia_nvjitlink_cu12-12.4.127-py3-none-manylinux2014_x86_64.whl (21.1 MB)\n",
            "\u001b[2K   \u001b[90m‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\u001b[0m \u001b[32m21.1/21.1 MB\u001b[0m \u001b[31m80.2 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n",
            "\u001b[?25hDownloading bs4-0.0.2-py2.py3-none-any.whl (1.2 kB)\n",
            "Downloading python_multipart-0.0.20-py3-none-any.whl (24 kB)\n",
            "Downloading starlette-0.46.2-py3-none-any.whl (72 kB)\n",
            "\u001b[2K   \u001b[90m‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\u001b[0m \u001b[32m72.0/72.0 kB\u001b[0m \u001b[31m5.9 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n",
            "\u001b[?25hInstalling collected packages: uvicorn, python-multipart, pyngrok, nvidia-nvjitlink-cu12, nvidia-curand-cu12, nvidia-cufft-cu12, nvidia-cuda-runtime-cu12, nvidia-cuda-nvrtc-cu12, nvidia-cuda-cupti-cu12, nvidia-cublas-cu12, starlette, nvidia-cusparse-cu12, nvidia-cudnn-cu12, bs4, nvidia-cusolver-cu12, fastapi\n",
            "  Attempting uninstall: nvidia-nvjitlink-cu12\n",
            "    Found existing installation: nvidia-nvjitlink-cu12 12.5.82\n",
            "    Uninstalling nvidia-nvjitlink-cu12-12.5.82:\n",
            "      Successfully uninstalled nvidia-nvjitlink-cu12-12.5.82\n",
            "  Attempting uninstall: nvidia-curand-cu12\n",
            "    Found existing installation: nvidia-curand-cu12 10.3.6.82\n",
            "    Uninstalling nvidia-curand-cu12-10.3.6.82:\n",
            "      Successfully uninstalled nvidia-curand-cu12-10.3.6.82\n",
            "  Attempting uninstall: nvidia-cufft-cu12\n",
            "    Found existing installation: nvidia-cufft-cu12 11.2.3.61\n",
            "    Uninstalling nvidia-cufft-cu12-11.2.3.61:\n",
            "      Successfully uninstalled nvidia-cufft-cu12-11.2.3.61\n",
            "  Attempting uninstall: nvidia-cuda-runtime-cu12\n",
            "    Found existing installation: nvidia-cuda-runtime-cu12 12.5.82\n",
            "    Uninstalling nvidia-cuda-runtime-cu12-12.5.82:\n",
            "      Successfully uninstalled nvidia-cuda-runtime-cu12-12.5.82\n",
            "  Attempting uninstall: nvidia-cuda-nvrtc-cu12\n",
            "    Found existing installation: nvidia-cuda-nvrtc-cu12 12.5.82\n",
            "    Uninstalling nvidia-cuda-nvrtc-cu12-12.5.82:\n",
            "      Successfully uninstalled nvidia-cuda-nvrtc-cu12-12.5.82\n",
            "  Attempting uninstall: nvidia-cuda-cupti-cu12\n",
            "    Found existing installation: nvidia-cuda-cupti-cu12 12.5.82\n",
            "    Uninstalling nvidia-cuda-cupti-cu12-12.5.82:\n",
            "      Successfully uninstalled nvidia-cuda-cupti-cu12-12.5.82\n",
            "  Attempting uninstall: nvidia-cublas-cu12\n",
            "    Found existing installation: nvidia-cublas-cu12 12.5.3.2\n",
            "    Uninstalling nvidia-cublas-cu12-12.5.3.2:\n",
            "      Successfully uninstalled nvidia-cublas-cu12-12.5.3.2\n",
            "  Attempting uninstall: nvidia-cusparse-cu12\n",
            "    Found existing installation: nvidia-cusparse-cu12 12.5.1.3\n",
            "    Uninstalling nvidia-cusparse-cu12-12.5.1.3:\n",
            "      Successfully uninstalled nvidia-cusparse-cu12-12.5.1.3\n",
            "  Attempting uninstall: nvidia-cudnn-cu12\n",
            "    Found existing installation: nvidia-cudnn-cu12 9.3.0.75\n",
            "    Uninstalling nvidia-cudnn-cu12-9.3.0.75:\n",
            "      Successfully uninstalled nvidia-cudnn-cu12-9.3.0.75\n",
            "  Attempting uninstall: nvidia-cusolver-cu12\n",
            "    Found existing installation: nvidia-cusolver-cu12 11.6.3.83\n",
            "    Uninstalling nvidia-cusolver-cu12-11.6.3.83:\n",
            "      Successfully uninstalled nvidia-cusolver-cu12-11.6.3.83\n",
            "Successfully installed bs4-0.0.2 fastapi-0.115.12 nvidia-cublas-cu12-12.4.5.8 nvidia-cuda-cupti-cu12-12.4.127 nvidia-cuda-nvrtc-cu12-12.4.127 nvidia-cuda-runtime-cu12-12.4.127 nvidia-cudnn-cu12-9.1.0.70 nvidia-cufft-cu12-11.2.1.3 nvidia-curand-cu12-10.3.5.147 nvidia-cusolver-cu12-11.6.1.9 nvidia-cusparse-cu12-12.3.1.170 nvidia-nvjitlink-cu12-12.4.127 pyngrok-7.2.8 python-multipart-0.0.20 starlette-0.46.2 uvicorn-0.34.2\n",
            "\u001b[1G\u001b[0K‚†ô\u001b[1G\u001b[0K‚†π\u001b[1G\u001b[0K‚†∏\u001b[1G\u001b[0K‚†º\u001b[1G\u001b[0K‚†¥\u001b[1G\u001b[0K‚†¶\u001b[1G\u001b[0K‚†ß\u001b[1G\u001b[0K‚†á\u001b[1G\u001b[0K‚†è\u001b[1G\u001b[0K‚†ã\u001b[1G\u001b[0K‚†ô\u001b[1G\u001b[0K‚†π\u001b[1G\u001b[0K‚†∏\u001b[1G\u001b[0K‚†º\u001b[1G\u001b[0K‚†¥\u001b[1G\u001b[0K‚†¶\u001b[1G\u001b[0K‚†ß\u001b[1G\u001b[0K‚†á\u001b[1G\u001b[0K‚†è\u001b[1G\u001b[0K‚†ã\u001b[1G\u001b[0K‚†ô\u001b[1G\u001b[0K‚†π\u001b[1G\u001b[0K‚†∏\u001b[1G\u001b[0K‚†º\u001b[1G\u001b[0K\n",
            "added 22 packages in 3s\n",
            "\u001b[1G\u001b[0K‚†º\u001b[1G\u001b[0K\n",
            "\u001b[1G\u001b[0K‚†º\u001b[1G\u001b[0K3 packages are looking for funding\n",
            "\u001b[1G\u001b[0K‚†º\u001b[1G\u001b[0K  run `npm fund` for details\n",
            "\u001b[1G\u001b[0K‚†º\u001b[1G\u001b[0K\u001b[1mnpm\u001b[22m \u001b[96mnotice\u001b[39m\n",
            "\u001b[1mnpm\u001b[22m \u001b[96mnotice\u001b[39m New \u001b[31mmajor\u001b[39m version of npm available! \u001b[31m10.8.2\u001b[39m -> \u001b[34m11.4.1\u001b[39m\n",
            "\u001b[1mnpm\u001b[22m \u001b[96mnotice\u001b[39m Changelog: \u001b[34mhttps://github.com/npm/cli/releases/tag/v11.4.1\u001b[39m\n",
            "\u001b[1mnpm\u001b[22m \u001b[96mnotice\u001b[39m To update run: \u001b[4mnpm install -g npm@11.4.1\u001b[24m\n",
            "\u001b[1mnpm\u001b[22m \u001b[96mnotice\u001b[39m\n",
            "\u001b[1G\u001b[0K‚†º\u001b[1G\u001b[0K"
          ]
        }
      ],
      "source": [
        "# –ù–∞–∂–º–∏—Ç–µ –Ω–∞ \"+ –ö–æ–¥\" –≤–≤–µ—Ä—Ö—É, –≤—Å—Ç–∞–≤—å—Ç–µ —ç—Ç–æ—Ç –∫–æ–¥ –∏ –∑–∞–ø—É—Å—Ç–∏—Ç–µ (‚ñ∂)\n",
        "\n",
        "!pip install fastapi uvicorn pyngrok nest-asyncio torch torchvision pillow numpy requests bs4 python-multipart\n",
        "!npm install -g localtunnel"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": 2,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "SaBEnCOex7v0",
        "outputId": "7a0dadc5-dc1f-46ff-d858-e79b1e37be16"
      },
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "Writing fashion_finder.py\n"
          ]
        }
      ],
      "source": [
        "# –ù–∞–∂–º–∏—Ç–µ \"+ –ö–æ–¥\", —Å–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—É—é —è—á–µ–π–∫—É –∏ –≤—Å—Ç–∞–≤—å—Ç–µ —ç—Ç–æ:\n",
        "\n",
        "%%writefile fashion_finder.py\n",
        "import os\n",
        "import sqlite3\n",
        "import numpy as np\n",
        "from datetime import datetime\n",
        "from pathlib import Path\n",
        "from fastapi import FastAPI, UploadFile, File\n",
        "from fastapi.staticfiles import StaticFiles\n",
        "from fastapi.responses import HTMLResponse, JSONResponse\n",
        "import nest_asyncio\n",
        "from pyngrok import ngrok\n",
        "import uvicorn\n",
        "from PIL import Image\n",
        "import torch\n",
        "import torchvision.models as models\n",
        "import torchvision.transforms as transforms\n",
        "import requests\n",
        "from bs4 import BeautifulSoup\n",
        "\n",
        "# ========== –ù–ê–°–¢–†–û–ô–ö–ê ==========\n",
        "app = FastAPI()\n",
        "BASE_DIR = Path(__file__).parent\n",
        "\n",
        "# –°–æ–∑–¥–∞–µ–º –ø–∞–ø–∫–∏\n",
        "for folder in ['uploads', 'wb_items', 'lamoda_items']:\n",
        "    (BASE_DIR / 'static' / folder).mkdir(parents=True, exist_ok=True)\n",
        "\n",
        "app.mount(\"/static\", StaticFiles(directory=BASE_DIR / \"static\"), name=\"static\")\n",
        "\n",
        "# ========== –ù–ï–ô–†–û–°–ï–¢–¨ ==========\n",
        "def load_model():\n",
        "    try:\n",
        "        model = models.resnet18(pretrained=True)\n",
        "        model = torch.nn.Sequential(*(list(model.children())[:-1]))\n",
        "        model.eval()\n",
        "        print(\"‚úÖ –ù–µ–π—Ä–æ—Å–µ—Ç—å –∑–∞–≥—Ä—É–∂–µ–Ω–∞\")\n",
        "        return model\n",
        "    except Exception as e:\n",
        "        print(f\"‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –º–æ–¥–µ–ª–∏: {e}\")\n",
        "        return None\n",
        "\n",
        "model = load_model()\n",
        "preprocess = transforms.Compose([\n",
        "    transforms.Resize(256),\n",
        "    transforms.CenterCrop(224),\n",
        "    transforms.ToTensor(),\n",
        "    transforms.Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225]),\n",
        "])\n",
        "\n",
        "# ========== –ë–ê–ó–ê –î–ê–ù–ù–´–• ==========\n",
        "def init_db():\n",
        "    conn = sqlite3.connect('fashion.db')\n",
        "    c = conn.cursor()\n",
        "    c.execute('''CREATE TABLE IF NOT EXISTS products\n",
        "                 (id INTEGER PRIMARY KEY,\n",
        "                 name TEXT, price TEXT, url TEXT,\n",
        "                 image_url TEXT, source TEXT,\n",
        "                 created_at TIMESTAMP)''')\n",
        "    conn.commit()\n",
        "    conn.close()\n",
        "\n",
        "init_db()\n",
        "\n",
        "# ========== –ü–û–ò–°–ö –ù–ê –ú–ê–†–ö–ï–¢–ü–õ–ï–ô–°–ê–• ==========\n",
        "def search_wildberries(query):\n",
        "    \"\"\"–ü–æ–∏—Å–∫ —Ç–æ–≤–∞—Ä–æ–≤ –Ω–∞ Wildberries\"\"\"\n",
        "    try:\n",
        "        url = f\"https://www.wildberries.ru/catalog/0/search.aspx?search={query}\"\n",
        "        headers = {\"User-Agent\": \"Mozilla/5.0\"}\n",
        "        response = requests.get(url, headers=headers)\n",
        "        soup = BeautifulSoup(response.text, 'html.parser')\n",
        "\n",
        "        results = []\n",
        "        for product in soup.select('.product-card')[:5]:\n",
        "            product_url = \"https://www.wildberries.ru\" + product.find('a')['href']\n",
        "            results.append({\n",
        "                \"name\": product.select_one('.goods-name').text.strip(),\n",
        "                \"price\": product.select_one('.price').text.strip(),\n",
        "                \"url\": product_url,\n",
        "                \"image\": product.select_one('img')['src'].replace('//', 'https://'),\n",
        "                \"source\": \"wildberries\"\n",
        "            })\n",
        "        return results\n",
        "    except Exception as e:\n",
        "        print(f\"–û—à–∏–±–∫–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞ Wildberries: {e}\")\n",
        "        return []\n",
        "\n",
        "def search_lamoda(query):\n",
        "    \"\"\"–ü–æ–∏—Å–∫ —Ç–æ–≤–∞—Ä–æ–≤ –Ω–∞ Lamoda\"\"\"\n",
        "    try:\n",
        "        url = f\"https://www.lamoda.ru/catalogsearch/result/?q={query}\"\n",
        "        headers = {\"User-Agent\": \"Mozilla/5.0\"}\n",
        "        response = requests.get(url, headers=headers)\n",
        "        soup = BeautifulSoup(response.text, 'html.parser')\n",
        "\n",
        "        results = []\n",
        "        for product in soup.select('.products-list-item')[:5]:\n",
        "            product_url = \"https://www.lamoda.ru\" + product.find('a')['href']\n",
        "            results.append({\n",
        "                \"name\": f\"{product.select_one('.products-list-item__brand').text.strip()} {product.select_one('.products-list-item__type').text.strip()}\",\n",
        "                \"price\": product.select_one('.price').text.strip(),\n",
        "                \"url\": product_url,\n",
        "                \"image\": product.select_one('img')['src'].replace('small', 'big'),\n",
        "                \"source\": \"lamoda\"\n",
        "            })\n",
        "        return results\n",
        "    except Exception as e:\n",
        "        print(f\"–û—à–∏–±–∫–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞ Lamoda: {e}\")\n",
        "        return []\n",
        "\n",
        "# ========== –í–ï–ë-–ò–ù–¢–ï–†–§–ï–ô–° ==========\n",
        "@app.get(\"/\", response_class=HTMLResponse)\n",
        "async def home():\n",
        "    return \"\"\"\n",
        "<!DOCTYPE html>\n",
        "<html lang=\"ru\">\n",
        "<head>\n",
        "    <meta charset=\"UTF-8\">\n",
        "    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n",
        "    <title>FashionFinder - –ü–æ–∏—Å–∫ –ø–æ—Ö–æ–∂–∏—Ö —Ç–æ–≤–∞—Ä–æ–≤</title>\n",
        "    <link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css\">\n",
        "    <style>\n",
        "        :root {\n",
        "            --primary: #4361ee;\n",
        "            --secondary: #3f37c9;\n",
        "            --accent: #4895ef;\n",
        "            --light: #f8f9fa;\n",
        "            --dark: #212529;\n",
        "            --success: #4cc9f0;\n",
        "            --warning: #f72585;\n",
        "            --border-radius: 12px;\n",
        "            --box-shadow: 0 8px 20px rgba(0, 0, 0, 0.1);\n",
        "        }\n",
        "\n",
        "        * {\n",
        "            margin: 0;\n",
        "            padding: 0;\n",
        "            box-sizing: border-box;\n",
        "            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;\n",
        "        }\n",
        "\n",
        "        body {\n",
        "            background-color: #f5f7ff;\n",
        "            color: var(--dark);\n",
        "            line-height: 1.6;\n",
        "            padding: 20px;\n",
        "        }\n",
        "\n",
        "        .container {\n",
        "            max-width: 1200px;\n",
        "            margin: 0 auto;\n",
        "        }\n",
        "\n",
        "        header {\n",
        "            text-align: center;\n",
        "            margin-bottom: 30px;\n",
        "        }\n",
        "\n",
        "        .logo {\n",
        "            font-size: 2.5rem;\n",
        "            font-weight: 700;\n",
        "            color: var(--primary);\n",
        "            margin-bottom: 10px;\n",
        "        }\n",
        "\n",
        "        .search-box {\n",
        "            background: white;\n",
        "            border-radius: var(--border-radius);\n",
        "            padding: 25px;\n",
        "            box-shadow: var(--box-shadow);\n",
        "            margin-bottom: 30px;\n",
        "        }\n",
        "\n",
        "        .input-group {\n",
        "            margin-bottom: 20px;\n",
        "        }\n",
        "\n",
        "        .input-group label {\n",
        "            display: block;\n",
        "            margin-bottom: 8px;\n",
        "            font-weight: 600;\n",
        "        }\n",
        "\n",
        "        .input-field {\n",
        "            width: 100%;\n",
        "            padding: 12px 15px;\n",
        "            border: 2px solid #e9ecef;\n",
        "            border-radius: var(--border-radius);\n",
        "            font-size: 16px;\n",
        "        }\n",
        "\n",
        "        .btn {\n",
        "            background: var(--primary);\n",
        "            color: white;\n",
        "            border: none;\n",
        "            padding: 12px 20px;\n",
        "            font-size: 16px;\n",
        "            border-radius: var(--border-radius);\n",
        "            cursor: pointer;\n",
        "            width: 100%;\n",
        "            transition: all 0.3s;\n",
        "        }\n",
        "\n",
        "        .btn:hover {\n",
        "            background: var(--secondary);\n",
        "        }\n",
        "\n",
        "        .results-container {\n",
        "            background: white;\n",
        "            border-radius: var(--border-radius);\n",
        "            padding: 25px;\n",
        "            box-shadow: var(--box-shadow);\n",
        "        }\n",
        "\n",
        "        .product-grid {\n",
        "            display: grid;\n",
        "            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));\n",
        "            gap: 20px;\n",
        "        }\n",
        "\n",
        "        .product-card {\n",
        "            border: 1px solid #eee;\n",
        "            border-radius: var(--border-radius);\n",
        "            overflow: hidden;\n",
        "            transition: all 0.3s;\n",
        "        }\n",
        "\n",
        "        .product-card:hover {\n",
        "            transform: translateY(-5px);\n",
        "            box-shadow: 0 10px 20px rgba(0,0,0,0.1);\n",
        "        }\n",
        "\n",
        "        .product-image {\n",
        "            width: 100%;\n",
        "            height: 200px;\n",
        "            object-fit: cover;\n",
        "        }\n",
        "\n",
        "        .product-info {\n",
        "            padding: 15px;\n",
        "        }\n",
        "\n",
        "        .product-title {\n",
        "            font-weight: 600;\n",
        "            margin-bottom: 8px;\n",
        "            display: -webkit-box;\n",
        "            -webkit-line-clamp: 2;\n",
        "            -webkit-box-orient: vertical;\n",
        "            overflow: hidden;\n",
        "        }\n",
        "\n",
        "        .product-price {\n",
        "            font-size: 18px;\n",
        "            font-weight: 700;\n",
        "            color: var(--warning);\n",
        "            margin-bottom: 8px;\n",
        "        }\n",
        "\n",
        "        .product-link {\n",
        "            display: inline-block;\n",
        "            width: 100%;\n",
        "            padding: 8px;\n",
        "            background: var(--accent);\n",
        "            color: white;\n",
        "            text-align: center;\n",
        "            border-radius: var(--border-radius);\n",
        "            text-decoration: none;\n",
        "            margin-top: 10px;\n",
        "        }\n",
        "\n",
        "        .loading {\n",
        "            text-align: center;\n",
        "            padding: 30px;\n",
        "            font-size: 18px;\n",
        "        }\n",
        "\n",
        "        .error {\n",
        "            color: var(--warning);\n",
        "            text-align: center;\n",
        "            padding: 20px;\n",
        "        }\n",
        "    </style>\n",
        "</head>\n",
        "<body>\n",
        "    <div class=\"container\">\n",
        "        <header>\n",
        "            <div class=\"logo\">FashionFinder</div>\n",
        "            <p>–ù–∞—Ö–æ–¥–∏—Ç–µ –ø–æ—Ö–æ–∂–∏–µ —Ç–æ–≤–∞—Ä—ã –Ω–∞ Wildberries, Ozon –∏ Lamoda</p>\n",
        "        </header>\n",
        "\n",
        "        <div class=\"search-box\">\n",
        "            <div class=\"input-group\">\n",
        "                <label for=\"productUrl\">–í—Å—Ç–∞–≤—å—Ç–µ —Å—Å—ã–ª–∫—É –Ω–∞ —Ç–æ–≤–∞—Ä:</label>\n",
        "                <input type=\"text\" id=\"productUrl\" class=\"input-field\"\n",
        "                       placeholder=\"https://www.wildberries.ru/catalog/12345678/detail.aspx\">\n",
        "            </div>\n",
        "            <button id=\"searchBtn\" class=\"btn\">\n",
        "                <i class=\"fas fa-search\"></i> –ù–∞–π—Ç–∏ –ø–æ—Ö–æ–∂–∏–µ\n",
        "            </button>\n",
        "        </div>\n",
        "\n",
        "        <div class=\"results-container\">\n",
        "            <div id=\"results\">\n",
        "                <div class=\"welcome-message\">\n",
        "                    <p>–í–≤–µ–¥–∏—Ç–µ —Å—Å—ã–ª–∫—É –Ω–∞ —Ç–æ–≤–∞—Ä, —á—Ç–æ–±—ã –Ω–∞–π—Ç–∏ –ø–æ—Ö–æ–∂–∏–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã</p>\n",
        "                </div>\n",
        "            </div>\n",
        "        </div>\n",
        "    </div>\n",
        "\n",
        "    <script>\n",
        "        // –í–∞—à API-–∫–ª—é—á Priceva\n",
        "        const PRICEVA_API_KEY = \"AYHJuIdjB8BbNbAmWdSTc4A26anuXSrv\";\n",
        "\n",
        "        document.addEventListener('DOMContentLoaded', function() {\n",
        "            const searchBtn = document.getElementById('searchBtn');\n",
        "            const productUrl = document.getElementById('productUrl');\n",
        "            const resultsDiv = document.getElementById('results');\n",
        "\n",
        "            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –ø–æ–∏—Å–∫–∞\n",
        "            searchBtn.addEventListener('click', findSimilarProducts);\n",
        "            productUrl.addEventListener('keypress', function(e) {\n",
        "                if (e.key === 'Enter') findSimilarProducts();\n",
        "            });\n",
        "\n",
        "            // –û—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –ø–æ–∏—Å–∫–∞\n",
        "            async function findSimilarProducts() {\n",
        "                const url = productUrl.value.trim();\n",
        "\n",
        "                if (!url) {\n",
        "                    showError(\"–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ —Å—Å—ã–ª–∫—É –Ω–∞ —Ç–æ–≤–∞—Ä\");\n",
        "                    return;\n",
        "                }\n",
        "\n",
        "                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∑–∞–≥—Ä—É–∑–∫—É\n",
        "                resultsDiv.innerHTML = '<div class=\"loading\"><i class=\"fas fa-spinner fa-spin\"></i> –ò—â–µ–º –ø–æ—Ö–æ–∂–∏–µ —Ç–æ–≤–∞—Ä—ã...</div>';\n",
        "\n",
        "                try {\n",
        "                    // –û–ø—Ä–µ–¥–µ–ª—è–µ–º ID —Ç–æ–≤–∞—Ä–∞ –∏–∑ URL\n",
        "                    const productId = parseProductId(url);\n",
        "                    if (!productId) {\n",
        "                        showError(\"–ù–µ —É–¥–∞–ª–æ—Å—å —Ä–∞—Å–ø–æ–∑–Ω–∞—Ç—å —Å—Å—ã–ª–∫—É. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å –≤–≤–æ–¥–∞.\");\n",
        "                        return;\n",
        "                    }\n",
        "\n",
        "                    // –û–ø—Ä–µ–¥–µ–ª—è–µ–º –ø–ª–∞—Ç—Ñ–æ—Ä–º—É (wb/ozon/lamoda)\n",
        "                    const platform = detectPlatform(url);\n",
        "\n",
        "                    // –ü–æ–ª—É—á–∞–µ–º –¥–∞–Ω–Ω—ã–µ —á–µ—Ä–µ–∑ Priceva API\n",
        "                    const similarProducts = await fetchPricevaData(productId, platform);\n",
        "\n",
        "                    // –û—Ç–æ–±—Ä–∞–∂–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã\n",
        "                    displayResults(similarProducts);\n",
        "                } catch (error) {\n",
        "                    console.error(\"–û—à–∏–±–∫–∞:\", error);\n",
        "                    showError(\"–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–∏—Å–∫–µ. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ.\");\n",
        "                }\n",
        "            }\n",
        "\n",
        "            // –ü–∞—Ä—Å–∏–º ID —Ç–æ–≤–∞—Ä–∞ –∏–∑ URL\n",
        "            function parseProductId(url) {\n",
        "                try {\n",
        "                    if (url.includes('wildberries')) {\n",
        "                        const match = url.match(/\\/catalog\\/(\\d+)\\//);\n",
        "                        return match ? match[1] : null;\n",
        "                    } else if (url.includes('ozon.ru')) {\n",
        "                        const match = url.match(/\\/t\\/([a-zA-Z0-9]+)/);\n",
        "                        return match ? match[1] : null;\n",
        "                    } else if (url.includes('lamoda')) {\n",
        "                        const match = url.match(/\\/p\\/([a-zA-Z0-9]+)\\//);\n",
        "                        return match ? match[1] : null;\n",
        "                    }\n",
        "                    return null;\n",
        "                } catch (e) {\n",
        "                    return null;\n",
        "                }\n",
        "            }\n",
        "\n",
        "            // –û–ø—Ä–µ–¥–µ–ª—è–µ–º –ø–ª–∞—Ç—Ñ–æ—Ä–º—É\n",
        "            function detectPlatform(url) {\n",
        "                if (url.includes('wildberries')) return 'wildberries';\n",
        "                if (url.includes('ozon.ru')) return 'ozon';\n",
        "                if (url.includes('lamoda')) return 'lamoda';\n",
        "                return 'unknown';\n",
        "            }\n",
        "\n",
        "            // –ó–∞–ø—Ä–æ—Å –∫ Priceva API\n",
        "            async function fetchPricevaData(productId, platform) {\n",
        "                // –í —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–æ–µ–∫—Ç–µ –∑–¥–µ—Å—å –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –∑–∞–ø—Ä–æ—Å –∫ –≤–∞—à–µ–º—É –±—ç–∫–µ–Ω–¥—É\n",
        "                // –î–ª—è –¥–µ–º–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º –º–æ–∫-–¥–∞–Ω–Ω—ã–µ\n",
        "\n",
        "                // –ò–º–∏—Ç–∞—Ü–∏—è –∑–∞–¥–µ—Ä–∂–∫–∏ API\n",
        "                await new Promise(resolve => setTimeout(resolve, 1500));\n",
        "\n",
        "                // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö\n",
        "                return Array.from({length: 6}, (_, i) => ({\n",
        "                    id: Math.floor(Math.random() * 100000000),\n",
        "                    title: `–ü–æ—Ö–æ–∂–∏–π —Ç–æ–≤–∞—Ä ${i+1} ${['—Ñ—É—Ç–±–æ–ª–∫–∞', '–¥–∂–∏–Ω—Å—ã', '–ø–ª–∞—Ç—å–µ', '–∫—Ä–æ—Å—Å–æ–≤–∫–∏'][i % 4]}`,\n",
        "                    price: Math.floor(Math.random() * 5000) + 1000,\n",
        "                    image: `https://picsum.photos/400/600?random=${i}`,\n",
        "                    url: generateProductUrl(platform),\n",
        "                    rating: (Math.random() + 4).toFixed(1)\n",
        "                }));\n",
        "\n",
        "                // –í —Ä–µ–∞–ª—å–Ω–æ–º –∫–æ–¥–µ —Ä–∞—Å–∫–æ–º–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ:\n",
        "                /*\n",
        "                const response = await fetch(`https://api.priceva.com/v1/products/${productId}`, {\n",
        "                    headers: {\n",
        "                        'Authorization': `Bearer ${PRICEVA_API_KEY}`\n",
        "                    }\n",
        "                });\n",
        "                const data = await response.json();\n",
        "                return data.similar_products || [];\n",
        "                */\n",
        "            }\n",
        "\n",
        "            // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è URL —Ç–æ–≤–∞—Ä–∞\n",
        "            function generateProductUrl(platform) {\n",
        "                const id = Math.floor(Math.random() * 100000000);\n",
        "                if (platform === 'wildberries') {\n",
        "                    return `https://www.wildberries.ru/catalog/${id}/detail.aspx`;\n",
        "                } else if (platform === 'ozon') {\n",
        "                    return `https://ozon.ru/t/${Math.random().toString(36).substr(2, 8)}`;\n",
        "                } else {\n",
        "                    return `https://www.lamoda.ru/p/RT${Math.random().toString(36).substr(2, 6).toUpperCase()}/`;\n",
        "                }\n",
        "            }\n",
        "\n",
        "            // –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤\n",
        "            function displayResults(products) {\n",
        "                if (!products || products.length === 0) {\n",
        "                    resultsDiv.innerHTML = '<div class=\"error\">–ü–æ—Ö–æ–∂–∏—Ö —Ç–æ–≤–∞—Ä–æ–≤ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ</div>';\n",
        "                    return;\n",
        "                }\n",
        "\n",
        "                let html = '<div class=\"product-grid\">';\n",
        "                products.forEach(product => {\n",
        "                    html += `\n",
        "                        <div class=\"product-card\">\n",
        "                            <img src=\"${product.image}\" alt=\"${product.title}\" class=\"product-image\">\n",
        "                            <div class=\"product-info\">\n",
        "                                <h3 class=\"product-title\">${product.title}</h3>\n",
        "                                <div class=\"product-price\">${product.price.toLocaleString()} ‚ÇΩ</div>\n",
        "                                <div class=\"product-rating\">‚≠ê ${product.rating}</div>\n",
        "                                <a href=\"${product.url}\" target=\"_blank\" class=\"product-link\">\n",
        "                                    <i class=\"fas fa-external-link-alt\"></i> –ü–µ—Ä–µ–π—Ç–∏\n",
        "                                </a>\n",
        "                            </div>\n",
        "                        </div>\n",
        "                    `;\n",
        "                });\n",
        "                html += '</div>';\n",
        "                resultsDiv.innerHTML = html;\n",
        "            }\n",
        "\n",
        "            // –ü–æ–∫–∞–∑–∞—Ç—å –æ—à–∏–±–∫—É\n",
        "            function showError(message) {\n",
        "                resultsDiv.innerHTML = `<div class=\"error\">${message}</div>`;\n",
        "            }\n",
        "        });\n",
        "    </script>\n",
        "</body>\n",
        "</html>\n",
        "    \"\"\"\n",
        "\n",
        "@app.post(\"/api/search\")\n",
        "async def search(file: UploadFile = File(...)):\n",
        "    try:\n",
        "        # 1. –°–æ—Ö—Ä–∞–Ω—è–µ–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ\n",
        "        upload_path = BASE_DIR / 'static' / 'uploads' / file.filename\n",
        "        with open(upload_path, \"wb\") as f:\n",
        "            f.write(await file.read())\n",
        "\n",
        "        # 2. –û–ø—Ä–µ–¥–µ–ª—è–µ–º –∫–∞—Ç–µ–≥–æ—Ä–∏—é (—É–ø—Ä–æ—â—ë–Ω–Ω–æ)\n",
        "        categories = [\"–ø–ª–∞—Ç—å–µ\", \"–¥–∂–∏–Ω—Å—ã\", \"—Ñ—É—Ç–±–æ–ª–∫–∞\", \"—Ä—É–±–∞—à–∫–∞\", \"–∫—Ä–æ—Å—Å–æ–≤–∫–∏\"]\n",
        "        category = categories[np.random.randint(0, len(categories))]  # –†–∞–Ω–¥–æ–º–Ω–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è –¥–ª—è —Ç–µ—Å—Ç–∞\n",
        "\n",
        "        # 3. –ò–º–∏—Ç–∞—Ü–∏—è –ø–æ–∏—Å–∫–∞ (–∑–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã–π API)\n",
        "        wb_items = [\n",
        "            {\n",
        "                \"name\": f\"{category} —Ç–µ—Å—Ç–æ–≤–æ–µ (Wildberries)\",\n",
        "                \"price\": f\"{np.random.randint(1000, 5000)} ‚ÇΩ\",\n",
        "                \"url\": f\"https://www.wildberries.ru/catalog/{np.random.randint(100000, 999999)}/detail.aspx\",\n",
        "                \"image\": f\"https://images.wbstatic.net/c516x688/new/{np.random.randint(100000, 999999)}-1.jpg\",\n",
        "                \"source\": \"wildberries\"\n",
        "            } for _ in range(3)\n",
        "        ]\n",
        "\n",
        "        lm_items = [\n",
        "            {\n",
        "                \"name\": f\"{category} —Ç–µ—Å—Ç–æ–≤–æ–µ (Lamoda)\",\n",
        "                \"price\": f\"{np.random.randint(800, 4000)} ‚ÇΩ\",\n",
        "                \"url\": f\"https://www.lamoda.ru/p/RT{np.random.randint(100000, 999999)}/\",\n",
        "                \"image\": f\"https://a.lmcdn.ru/img{np.random.randint(100000, 999999)}.jpg\",\n",
        "                \"source\": \"lamoda\"\n",
        "            } for _ in range(2)\n",
        "        ]\n",
        "\n",
        "        return JSONResponse({\n",
        "            \"status\": \"success\",\n",
        "            \"wildberries\": wb_items,\n",
        "            \"lamoda\": lm_items\n",
        "        })\n",
        "\n",
        "    except Exception as e:\n",
        "        return JSONResponse({\"status\": \"error\", \"message\": str(e)}, status_code=500)\n",
        "@app.get(\"/test-search\")\n",
        "async def test_search():\n",
        "    test_items = [\n",
        "        {\n",
        "            \"name\": \"–î–∂–∏–Ω—Å—ã —Å–∏–Ω–∏–µ –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–µ\",\n",
        "            \"price\": \"2990 ‚ÇΩ\",\n",
        "            \"url\": \"https://www.wildberries.ru/catalog/123456/detail.aspx\",\n",
        "            \"image\": \"https://images.wbstatic.net/c516x688/new/123456-1.jpg\",\n",
        "            \"source\": \"wildberries\"\n",
        "        },\n",
        "        {\n",
        "            \"name\": \"–§—É—Ç–±–æ–ª–∫–∞ –±–µ–ª–∞—è —Ö–ª–æ–ø–∫–æ–≤–∞—è\",\n",
        "            \"price\": \"1490 ‚ÇΩ\",\n",
        "            \"url\": \"https://www.lamoda.ru/p/RT123456/\",\n",
        "            \"image\": \"https://a.lmcdn.ru/img123456.jpg\",\n",
        "            \"source\": \"lamoda\"\n",
        "        }\n",
        "    ]\n",
        "    return JSONResponse({\"status\": \"test\", \"items\": test_items})\n",
        "if __name__ == \"__main__\":\n",
        "    nest_asyncio.apply()\n",
        "    port = 8000\n",
        "\n",
        "    try:\n",
        "        public_url = ngrok.connect(port).public_url\n",
        "        print(f\"üöÄ –°–µ—Ä–≤–µ—Ä –∑–∞–ø—É—â–µ–Ω: {public_url}\")\n",
        "    except Exception as e:\n",
        "        print(f\"‚ö†Ô∏è Ngrok –Ω–µ –∑–∞–ø—É—â–µ–Ω: {e}\")\n",
        "        print(\"üîå –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ localtunnel –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∏–∑ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞\")\n",
        "        print(\"!lt --port 8000\")\n",
        "\n",
        "    uvicorn.run(app, host=\"0.0.0.0\", port=port)"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "zYjGgxRlx9US",
        "outputId": "683131c7-7dba-45b1-8b3c-89602d510bc3"
      },
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "/usr/local/lib/python3.11/dist-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.\n",
            "  warnings.warn(\n",
            "/usr/local/lib/python3.11/dist-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=ResNet18_Weights.IMAGENET1K_V1`. You can also use `weights=ResNet18_Weights.DEFAULT` to get the most up-to-date weights.\n",
            "  warnings.warn(msg)\n",
            "Downloading: \"https://download.pytorch.org/models/resnet18-f37072fd.pth\" to /root/.cache/torch/hub/checkpoints/resnet18-f37072fd.pth\n",
            "100% 44.7M/44.7M [00:00<00:00, 139MB/s]\n",
            "‚úÖ –ù–µ–π—Ä–æ—Å–µ—Ç—å –∑–∞–≥—Ä—É–∂–µ–Ω–∞\n",
            "t=2025-05-25T09:30:14+0000 lvl=eror msg=\"failed to reconnect session\" obj=tunnels.session err=\"authentication failed: Usage of ngrok requires a verified account and authtoken.\\n\\nSign up for an account: https://dashboard.ngrok.com/signup\\nInstall your authtoken: https://dashboard.ngrok.com/get-started/your-authtoken\\r\\n\\r\\nERR_NGROK_4018\\r\\n\"\n",
            "t=2025-05-25T09:30:14+0000 lvl=eror msg=\"session closing\" obj=tunnels.session err=\"authentication failed: Usage of ngrok requires a verified account and authtoken.\\n\\nSign up for an account: https://dashboard.ngrok.com/signup\\nInstall your authtoken: https://dashboard.ngrok.com/get-started/your-authtoken\\r\\n\\r\\nERR_NGROK_4018\\r\\n\"\n",
            "t=2025-05-25T09:30:14+0000 lvl=eror msg=\"terminating with error\" obj=app err=\"authentication failed: Usage of ngrok requires a verified account and authtoken.\\n\\nSign up for an account: https://dashboard.ngrok.com/signup\\nInstall your authtoken: https://dashboard.ngrok.com/get-started/your-authtoken\\r\\n\\r\\nERR_NGROK_4018\\r\\n\"\n",
            "ERROR:  authentication failed: Usage of ngrok requires a verified account and authtoken.\n",
            "ERROR:  \n",
            "ERROR:  Sign up for an account: https://dashboard.ngrok.com/signup\n",
            "ERROR:  Install your authtoken: https://dashboard.ngrok.com/get-started/your-authtoken\n",
            "ERROR:  \n",
            "ERROR:  ERR_NGROK_4018\n",
            "ERROR:  https://ngrok.com/docs/errors/err_ngrok_4018\n",
            "ERROR:  \n",
            "t=2025-05-25T09:30:14+0000 lvl=crit msg=\"command failed\" err=\"authentication failed: Usage of ngrok requires a verified account and authtoken.\\n\\nSign up for an account: https://dashboard.ngrok.com/signup\\nInstall your authtoken: https://dashboard.ngrok.com/get-started/your-authtoken\\r\\n\\r\\nERR_NGROK_4018\\r\\n\"\n",
            "‚ö†Ô∏è Ngrok –Ω–µ –∑–∞–ø—É—â–µ–Ω: The ngrok process errored on start: authentication failed: Usage of ngrok requires a verified account and authtoken.\\n\\nSign up for an account: https://dashboard.ngrok.com/signup\\nInstall your authtoken: https://dashboard.ngrok.com/get-started/your-authtoken\\r\\n\\r\\nERR_NGROK_4018\\r\\n.\n",
            "üîå –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ localtunnel –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∏–∑ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞\n",
            "!lt --port 8000\n",
            "\u001b[32mINFO\u001b[0m:     Started server process [\u001b[36m811\u001b[0m]\n",
            "\u001b[32mINFO\u001b[0m:     Waiting for application startup.\n",
            "\u001b[32mINFO\u001b[0m:     Application startup complete.\n",
            "\u001b[32mINFO\u001b[0m:     Uvicorn running on \u001b[1mhttp://0.0.0.0:8000\u001b[0m (Press CTRL+C to quit)\n"
          ]
        }
      ],
      "source": [
        "# –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—É—é —è—á–µ–π–∫—É –∏ –≤—Å—Ç–∞–≤—å—Ç–µ:\n",
        "\n",
        "!python fashion_finder.py"
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "!pip install pyngrok\n",
        "!ngrok authtoken 2xSn8k36TmtjAtWItr2jMYlwrkA_5ZuF8E8SVnvzWcr9nSbKP  # –ó–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ —Ç–æ–∫–µ–Ω –∏–∑ –ª–∏—á–Ω–æ–≥–æ –∫–∞–±–∏–Ω–µ—Ç–∞\n",
        "!python fashion_finder.py"
      ],
      "metadata": {
        "id": "PQWgZbLDnUOE"
      },
      "execution_count": null,
      "outputs": []
    }
  ],
  "metadata": {
    "colab": {
      "provenance": [],
      "authorship_tag": "ABX9TyNhkA3ADrrSphlaIVcQpYl9"
    },
    "kernelspec": {
      "display_name": "Python 3",
      "name": "python3"
    },
    "language_info": {
      "name": "python"
    }
  },
  "nbformat": 4,
  "nbformat_minor": 0
}
